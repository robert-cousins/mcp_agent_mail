{"jsonrpc":"2.0","id":5,"result":{"tools":[{"name":"health_check","description":"Check server readiness. Returns {status, environment, http_host, http_port, database_url}.","inputSchema":{"properties":{"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"ensure_project","description":"Create/ensure a project exists. human_key MUST be an absolute path. Returns {id, slug, human_key, created_at}.","inputSchema":{"properties":{"human_key":{"type":"string"},"identity_mode":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["human_key"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"register_agent","description":"Register or update an agent identity. Omit 'name' to auto-generate (recommended). Returns {id, name, program, model, ...}.","inputSchema":{"properties":{"project_key":{"type":"string"},"program":{"type":"string"},"model":{"type":"string"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"task_description":{"default":"","type":"string"},"attachments_policy":{"default":"auto","type":"string"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","program","model"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"whois","description":"Return enriched profile details for an agent, optionally including recent archive commits.\n\nDiscovery\n---------\nTo discover available agent names, use: resource://agents/{project_key}\nAgent names are NOT the same as program names or user names.\n\nParameters\n----------\nproject_key : str\n    Project slug or human key.\nagent_name : str\n    Agent name to look up (use resource://agents/{project_key} to discover names).\ninclude_recent_commits : bool\n    If true, include latest commits touching the project archive authored by the configured git author.\ncommit_limit : int\n    Maximum number of recent commits to include.\n\nReturns\n-------\ndict\n    Agent profile augmented with { recent_commits: [{hexsha, summary, authored_ts}] } when requested.","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"include_recent_commits":{"default":true,"type":"boolean"},"commit_limit":{"default":5,"type":"integer"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"create_agent_identity","description":"Create a new, unique agent identity and persist its profile to Git.\n\nHow this differs from `register_agent`\n--------------------------------------\n- Always creates a new identity with a fresh unique name (never updates an existing one).\n- `name_hint`, if provided, MUST be a valid adjective+noun combination and must be available,\n  otherwise an error is raised. Without a hint, a random adjective+noun name is generated.\n\nCRITICAL: Agent Naming Rules\n-----------------------------\n- Agent names MUST be randomly generated adjective+noun combinations\n- Examples: \"GreenCastle\", \"BlueLake\", \"RedStone\", \"PurpleBear\"\n- Names should be unique, easy to remember, and NOT descriptive\n- INVALID examples: \"BackendHarmonizer\", \"DatabaseMigrator\", \"UIRefactorer\"\n- Best practice: Omit `name_hint` to auto-generate a valid name (RECOMMENDED)\n\nWhen to use\n-----------\n- Spawning a brand new worker agent that should not overwrite an existing profile.\n- Temporary task-specific identities (e.g., short-lived refactor assistants).\n\nReturns\n-------\ndict\n    { id, name, program, model, task_description, inception_ts, last_active_ts, project_id }\n\nExamples\n--------\nAuto-generate name (RECOMMENDED):\n```json\n{\"jsonrpc\":\"2.0\",\"id\":\"c2\",\"method\":\"tools/call\",\"params\":{\"name\":\"create_agent_identity\",\"arguments\":{\n  \"project_key\":\"/data/projects/backend\",\"program\":\"claude-code\",\"model\":\"opus-4.1\"\n}}}\n```\n\nWith valid name hint:\n```json\n{\"jsonrpc\":\"2.0\",\"id\":\"c1\",\"method\":\"tools/call\",\"params\":{\"name\":\"create_agent_identity\",\"arguments\":{\n  \"project_key\":\"/data/projects/backend\",\"program\":\"codex-cli\",\"model\":\"gpt5-codex\",\"name_hint\":\"GreenCastle\",\n  \"task_description\":\"DB migration spike\"\n}}}\n```","inputSchema":{"properties":{"project_key":{"type":"string"},"program":{"type":"string"},"model":{"type":"string"},"name_hint":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"task_description":{"default":"","type":"string"},"attachments_policy":{"default":"auto","type":"string"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","program","model"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"send_message","description":"Send a Markdown message to recipients. Returns {deliveries: [...], count: int}.","inputSchema":{"properties":{"project_key":{"type":"string"},"sender_name":{"type":"string"},"to":{"items":{"type":"string"},"type":"array"},"subject":{"type":"string"},"body_md":{"type":"string"},"cc":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"default":null},"bcc":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"default":null},"attachment_paths":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"default":null},"convert_images":{"anyOf":[{"type":"boolean"},{"type":"null"}],"default":null},"importance":{"default":"normal","type":"string"},"ack_required":{"default":false,"type":"boolean"},"thread_id":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"auto_contact_if_blocked":{"default":false,"type":"boolean"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","sender_name","to","subject","body_md"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"reply_message","description":"Reply to an existing message, preserving or establishing a thread.\n\nBehavior\n--------\n- Inherits original `importance` and `ack_required` flags\n- `thread_id` is taken from the original message if present; otherwise, the original id is used\n- Subject is prefixed with `subject_prefix` if not already present\n- Defaults `to` to the original sender if not explicitly provided\n\nParameters\n----------\nproject_key : str\n    Project identifier.\nmessage_id : int\n    The id of the message you are replying to.\nsender_name : str\n    Your agent name (must be registered in the project).\nbody_md : str\n    Reply body in Markdown.\nto, cc, bcc : Optional[list[str]]\n    Recipients by agent name. If omitted, `to` defaults to original sender.\nsubject_prefix : str\n    Prefix to apply (default \"Re:\"). Case-insensitive idempotent.\n\nDo / Don't\n----------\nDo:\n- Keep the subject focused; avoid topic drift within a thread.\n- Reply to the original sender unless new stakeholders are strictly required.\n- Preserve importance/ack flags from the original unless there is a clear reason to change.\n- Use CC for FYI only; BCC sparingly and with intention.\n\nDon't:\n- Change `thread_id` when continuing the same discussion.\n- Escalate to many recipients; prefer targeted replies and start a new thread for new topics.\n- Attach large binaries in replies unless essential; reference prior attachments where possible.\n\nReturns\n-------\ndict\n    Message payload including `thread_id` and `reply_to`.\n\nExamples\n--------\nMinimal reply to original sender:\n```json\n{\"jsonrpc\":\"2.0\",\"id\":\"6\",\"method\":\"tools/call\",\"params\":{\"name\":\"reply_message\",\"arguments\":{\n  \"project_key\":\"/abs/path/backend\",\"message_id\":1234,\"sender_name\":\"BlueLake\",\n  \"body_md\":\"Questions about the migration plan...\"\n}}}\n```\n\nReply with explicit recipients and CC:\n```json\n{\"jsonrpc\":\"2.0\",\"id\":\"6c\",\"method\":\"tools/call\",\"params\":{\"name\":\"reply_message\",\"arguments\":{\n  \"project_key\":\"/abs/path/backend\",\"message_id\":1234,\"sender_name\":\"BlueLake\",\n  \"body_md\":\"Looping ops.\",\"to\":[\"GreenCastle\"],\"cc\":[\"RedCat\"],\"subject_prefix\":\"RE:\"\n}}}\n```","inputSchema":{"properties":{"project_key":{"type":"string"},"message_id":{"type":"integer"},"sender_name":{"type":"string"},"body_md":{"type":"string"},"to":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"default":null},"cc":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"default":null},"bcc":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"default":null},"subject_prefix":{"default":"Re:","type":"string"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","message_id","sender_name","body_md"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"request_contact","description":"Request contact approval to message another agent.\n\nCreates (or refreshes) a pending AgentLink and sends a small ack_required intro message.\n\nDiscovery\n---------\nTo discover available agent names, use: resource://agents/{project_key}\nAgent names are NOT the same as program names or user names.\n\nParameters\n----------\nproject_key : str\n    Project slug or human key.\nfrom_agent : str\n    Your agent name (must be registered in the project).\nto_agent : str\n    Target agent name (use resource://agents/{project_key} to discover names).\nto_project : Optional[str]\n    Target project if different from your project (cross-project coordination).\nreason : str\n    Optional explanation for the contact request.\nttl_seconds : int\n    Time to live for the contact approval request (default: 7 days).","inputSchema":{"properties":{"project_key":{"type":"string"},"from_agent":{"type":"string"},"to_agent":{"type":"string"},"to_project":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"reason":{"default":"","type":"string"},"ttl_seconds":{"default":604800,"type":"integer"},"register_if_missing":{"default":true,"type":"boolean"},"program":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"model":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"task_description":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","from_agent","to_agent"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"respond_contact","description":"Approve or deny a contact request.","inputSchema":{"properties":{"project_key":{"type":"string"},"to_agent":{"type":"string"},"from_agent":{"type":"string"},"accept":{"type":"boolean"},"ttl_seconds":{"default":2592000,"type":"integer"},"from_project":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","to_agent","from_agent","accept"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"list_contacts","description":"List contact links for an agent in a project.","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name"],"type":"object"},"outputSchema":{"properties":{"result":{"items":{"additionalProperties":true,"type":"object"},"type":"array"}},"required":["result"],"type":"object","x-fastmcp-wrap-result":true},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"set_contact_policy","description":"Set contact policy for an agent: open | auto | contacts_only | block_all.","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"policy":{"type":"string"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name","policy"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"fetch_inbox","description":"Get recent messages for an agent. Returns list of {id, subject, from, created_ts, importance, ...}.","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"limit":{"default":20,"type":"integer"},"urgent_only":{"default":false,"type":"boolean"},"include_bodies":{"default":false,"type":"boolean"},"since_ts":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name"],"type":"object"},"outputSchema":{"properties":{"result":{"items":{"additionalProperties":true,"type":"object"},"type":"array"}},"required":["result"],"type":"object","x-fastmcp-wrap-result":true},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"mark_message_read","description":"Mark a specific message as read for the given agent.\n\nNotes\n-----\n- Read receipts are per-recipient; this only affects the specified agent.\n- This does not send an acknowledgement; use `acknowledge_message` for that.\n- Safe to call multiple times; later calls return the original timestamp.\n\nIdempotency\n-----------\n- If `mark_message_read` has already been called earlier for the same (agent, message),\n  the original timestamp is returned and no error is raised.\n\nReturns\n-------\ndict\n    { message_id, read: bool, read_at: iso8601 | null }\n\nExample\n-------\n```json\n{\"jsonrpc\":\"2.0\",\"id\":\"8\",\"method\":\"tools/call\",\"params\":{\"name\":\"mark_message_read\",\"arguments\":{\n  \"project_key\":\"/abs/path/backend\",\"agent_name\":\"BlueLake\",\"message_id\":1234\n}}}\n```","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"message_id":{"type":"integer"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name","message_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"acknowledge_message","description":"Acknowledge a message (marks as read too). Returns {message_id, acknowledged, acknowledged_at, read_at}.","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"message_id":{"type":"integer"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name","message_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"macro_start_session","description":"Macro helper that boots a project session: ensure project, register agent,\noptionally file_reservation paths, and fetch the latest inbox snapshot.","inputSchema":{"properties":{"human_key":{"type":"string"},"program":{"type":"string"},"model":{"type":"string"},"task_description":{"default":"","type":"string"},"agent_name":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"file_reservation_paths":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"default":null},"file_reservation_reason":{"default":"macro-session","type":"string"},"file_reservation_ttl_seconds":{"default":3600,"type":"integer"},"inbox_limit":{"default":10,"type":"integer"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["human_key","program","model"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"macro_prepare_thread","description":"Macro helper that aligns an agent with an existing thread by ensuring registration,\nsummarising the thread, and fetching recent inbox context.","inputSchema":{"properties":{"project_key":{"type":"string"},"thread_id":{"type":"string"},"program":{"type":"string"},"model":{"type":"string"},"agent_name":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"task_description":{"default":"","type":"string"},"register_if_missing":{"default":true,"type":"boolean"},"include_examples":{"default":true,"type":"boolean"},"inbox_limit":{"default":10,"type":"integer"},"include_inbox_bodies":{"default":false,"type":"boolean"},"llm_mode":{"default":true,"type":"boolean"},"llm_model":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","thread_id","program","model"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"macro_file_reservation_cycle","description":"Reserve a set of file paths and optionally release them at the end of the workflow.","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"paths":{"items":{"type":"string"},"type":"array"},"ttl_seconds":{"default":3600,"type":"integer"},"exclusive":{"default":true,"type":"boolean"},"reason":{"default":"macro-file_reservation","type":"string"},"auto_release":{"default":false,"type":"boolean"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name","paths"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"macro_contact_handshake","description":"Request contact permissions and optionally auto-approve plus send a welcome message.","inputSchema":{"properties":{"project_key":{"type":"string"},"requester":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"target":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"reason":{"default":"","type":"string"},"ttl_seconds":{"default":604800,"type":"integer"},"auto_accept":{"default":false,"type":"boolean"},"welcome_subject":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"welcome_body":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"to_project":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"agent_name":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"to_agent":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"register_if_missing":{"default":true,"type":"boolean"},"program":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"model":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"task_description":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"thread_id":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"search_messages","description":"Full-text search over subject and body for a project.\n\nTips\n----\n- SQLite FTS5 syntax supported: phrases (\"build plan\"), prefix (mig*), boolean (plan AND users)\n- Results are ordered by bm25 score (best matches first)\n- Limit defaults to 20; raise for broad queries\n\nQuery examples\n---------------\n- Phrase search: `\"build plan\"`\n- Prefix: `migrat*`\n- Boolean: `plan AND users`\n- Require urgent: `urgent AND deployment`\n\nParameters\n----------\nproject_key : str\n    Project identifier.\nquery : str\n    FTS5 query string.\nlimit : int\n    Max results to return.\n\nReturns\n-------\nlist[dict]\n    Each entry: { id, subject, importance, ack_required, created_ts, thread_id, from }\n\nExample\n-------\n```json\n{\"jsonrpc\":\"2.0\",\"id\":\"10\",\"method\":\"tools/call\",\"params\":{\"name\":\"search_messages\",\"arguments\":{\n  \"project_key\":\"/abs/path/backend\",\"query\":\"\"build plan\" AND users\", \"limit\": 50\n}}}\n```","inputSchema":{"properties":{"project_key":{"type":"string"},"query":{"type":"string"},"limit":{"default":20,"type":"integer"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","query"],"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"summarize_thread","description":"Extract participants, key points, and action items for one or more threads.\n\nSingle-thread mode (thread_id is a single ID):\n- Returns detailed summary with optional example messages\n- Response: { thread_id, summary: {participants[], key_points[], action_items[]}, examples[] }\n\nMulti-thread mode (thread_id is comma-separated IDs like \"TKT-1,TKT-2,TKT-3\"):\n- Returns aggregate digest across all threads\n- Response: { threads: [{thread_id, summary}], aggregate: {top_mentions[], key_points[], action_items[]} }\n\nParameters\n----------\nproject_key : str\n    Project identifier.\nthread_id : str\n    Single thread ID for detailed summary, OR comma-separated IDs for aggregate digest.\ninclude_examples : bool\n    If true (single-thread mode only), include up to 3 sample messages.\nllm_mode : bool\n    If true and LLM is enabled, refine the summary with AI.\nllm_model : Optional[str]\n    Override model name for the LLM call.\nper_thread_limit : int\n    Max messages to consider per thread (multi-thread mode).\n\nExamples\n--------\nSingle thread:\n```json\n{\"thread_id\": \"TKT-123\", \"include_examples\": true}\n```\n\nMultiple threads:\n```json\n{\"thread_id\": \"TKT-1,TKT-2,TKT-3\"}\n```","inputSchema":{"properties":{"project_key":{"type":"string"},"thread_id":{"type":"string"},"include_examples":{"default":false,"type":"boolean"},"llm_mode":{"default":true,"type":"boolean"},"llm_model":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null},"per_thread_limit":{"default":50,"type":"integer"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","thread_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"install_precommit_guard","inputSchema":{"properties":{"project_key":{"type":"string"},"code_repo_path":{"type":"string"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","code_repo_path"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"uninstall_precommit_guard","inputSchema":{"properties":{"code_repo_path":{"type":"string"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["code_repo_path"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"file_reservation_paths","description":"Request advisory file reservations (leases) on project-relative paths/globs.\n\nSemantics\n---------\n- Conflicts are reported if an overlapping active exclusive reservation exists held by another agent\n- Glob matching is symmetric (`fnmatchcase(a,b)` or `fnmatchcase(b,a)`), including exact matches\n- When granted, a JSON artifact is written under `file_reservations/<sha1(path)>.json` and the DB is updated\n- TTL must be >= 60 seconds (enforced by the server settings/policy)\n- Server-side enforcement (if enabled) only checks reservations that target mail archive paths\n  such as `agents/`, `messages/`, or `attachments/`; code repo enforcement is via the pre-commit guard\n\nDo / Don't\n----------\nDo:\n- Reserve files before starting edits to signal intent to other agents.\n- Use specific, minimal patterns (e.g., `app/api/*.py`) instead of broad globs.\n- Set a realistic TTL and renew with `renew_file_reservations` if you need more time.\n\nDon't:\n- Reserve the entire repository or very broad patterns (e.g., `**/*`) unless absolutely necessary.\n- Hold long-lived exclusive reservations when you are not actively editing.\n- Ignore conflicts; resolve them by coordinating with holders or waiting for expiry.\n\nParameters\n----------\nproject_key : str\nagent_name : str\npaths : list[str]\n    File paths or glob patterns relative to the project workspace (e.g., \"app/api/*.py\").\nttl_seconds : int\n    Time to live for the file_reservation; expired file_reservations are auto-released.\nexclusive : bool\n    If true, exclusive intent; otherwise shared/observe-only.\nreason : str\n    Optional explanation (helps humans reviewing Git artifacts).\n\nReturns\n-------\ndict\n    { granted: [{id, path_pattern, exclusive, reason, expires_ts}], conflicts: [{path, holders: [...]}] }\n\nExample\n-------\n```json\n{\"jsonrpc\":\"2.0\",\"id\":\"12\",\"method\":\"tools/call\",\"params\":{\"name\":\"file_reservation_paths\",\"arguments\":{\n  \"project_key\":\"/abs/path/backend\",\"agent_name\":\"GreenCastle\",\"paths\":[\"app/api/*.py\"],\n  \"ttl_seconds\":7200,\"exclusive\":true,\"reason\":\"migrations\"\n}}}\n```","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"paths":{"items":{"type":"string"},"type":"array"},"ttl_seconds":{"default":3600,"type":"integer"},"exclusive":{"default":true,"type":"boolean"},"reason":{"default":"","type":"string"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name","paths"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"release_file_reservations","description":"Release active file reservations held by an agent.\n\nBehavior\n--------\n- If both `paths` and `file_reservation_ids` are omitted, all active reservations for the agent are released\n- Otherwise, restricts release to matching ids and/or path patterns\n- JSON artifacts stay in Git for audit; DB records get `released_ts`\n\nReturns\n-------\ndict\n    { released: int, released_at: iso8601 }\n\nIdempotency\n-----------\n- Safe to call repeatedly. Releasing an already-released (or non-existent) reservation is a no-op.\n\nExamples\n--------\nRelease all active reservations for agent:\n```json\n{\"jsonrpc\":\"2.0\",\"id\":\"13\",\"method\":\"tools/call\",\"params\":{\"name\":\"release_file_reservations\",\"arguments\":{\n  \"project_key\":\"/abs/path/backend\",\"agent_name\":\"GreenCastle\"\n}}}\n```\n\nRelease by ids:\n```json\n{\"jsonrpc\":\"2.0\",\"id\":\"14\",\"method\":\"tools/call\",\"params\":{\"name\":\"release_file_reservations\",\"arguments\":{\n  \"project_key\":\"/abs/path/backend\",\"agent_name\":\"GreenCastle\",\"file_reservation_ids\":[101,102]\n}}}\n```","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"paths":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"default":null},"file_reservation_ids":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"default":null},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"force_release_file_reservation","description":"Force-release a stale file reservation held by another agent after inactivity heuristics.\n\nThe tool validates that the reservation appears abandoned (agent inactive beyond threshold and\nno recent mail/filesystem/git activity). When released, an optional notification is sent to the\nprevious holder summarizing the heuristics.","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"file_reservation_id":{"type":"integer"},"notify_previous":{"default":true,"type":"boolean"},"note":{"default":"","type":"string"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name","file_reservation_id"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}},{"name":"renew_file_reservations","description":"Extend expiry for active file reservations held by an agent without reissuing them.\n\nParameters\n----------\nproject_key : str\n    Project slug or human key.\nagent_name : str\n    Agent identity who owns the reservations.\nextend_seconds : int\n    Seconds to extend from the later of now or current expiry (min 60s).\npaths : Optional[list[str]]\n    Restrict renewals to matching path patterns.\nfile_reservation_ids : Optional[list[int]]\n    Restrict renewals to matching reservation ids.\n\nReturns\n-------\ndict\n    { renewed: int, file_reservations: [{id, path_pattern, old_expires_ts, new_expires_ts}] }","inputSchema":{"properties":{"project_key":{"type":"string"},"agent_name":{"type":"string"},"extend_seconds":{"default":1800,"type":"integer"},"paths":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"default":null},"file_reservation_ids":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"default":null},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null}},"required":["project_key","agent_name"],"type":"object"},"outputSchema":{"additionalProperties":true,"type":"object"},"_meta":{"_fastmcp":{"tags":[]}}}]}}